[{"_path":"/blog/2024/03/setting-the-timezone-in-alpine","_dir":"03","_draft":false,"_partial":false,"_locale":"en","title":"Configuring Timezone in Alpine Linux: Handling in Local Environment and Docker Images","description":"In a production environment, a time zone must be manually set up for reasons such as cron job, log time localization, and time synchronization betw...","createdAt":"2024-03-05 13:05","updatedAt":null,"cover":"/s3/devlog/1_setting-the-timezone-in-alpine/072bf123-f28a-4603-b6ef-48cb012da79a.webp","tags":["Alpine linux","Docker"],"body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In a production environment, there are times when you need to set the time zone yourself for reasons such as cron work, log time localization, and time synchronization between DB and OS.\nThe time zone setting method differs depending on the linux distribution. In this article, we will learn how to set the time zone in Alpine Linux, one of the lightweight Linux distributions, and how to optimize and apply it when setting in a Docker environment."}]},{"type":"element","tag":"h2","props":{"id":"time-zone-settings-in-local-environment"},"children":[{"type":"text","value":"Time zone settings in local environment"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"First, let's look at how to set it up in a local environment by installing it directly on your computer."}]},{"type":"element","tag":"h3","props":{"id":"installing-the-tzdata-package"},"children":[{"type":"text","value":"Installing the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"tzdata"}]},{"type":"text","value":" package"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Since Alpine Linux does not include packages related to time zone settings, install the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"tzdata"}]},{"type":"text","value":" package."}]},{"type":"element","tag":"pre","props":{"code":"apk add tzdata \n","filename":"Terminal","language":"bash","meta":"","className":"language-bash shiki shiki-themes github-light material-theme-ocean","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"apk"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" add"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" tzdata\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Check whether the package was installed properly using the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"ls -L"}]},{"type":"text","value":" command.\nThis command displays information about the actual file or directory pointed to by the symbolic link."}]},{"type":"element","tag":"code-group","props":{},"children":[{"type":"element","tag":"pre","props":{"code":"ls -L /usr/share/zoneinfo/\n","filename":"Terminal","language":"bash","meta":"","className":"language-bash shiki shiki-themes github-light material-theme-ocean","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"ls"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" -L"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" /usr/share/zoneinfo/\n"}]}]}]}]},{"type":"element","tag":"pre","props":{"code":"Africa             CST6CDT            Etc                Greenwich          Kwajalein          PRC                UCT                posixrules       \nAmerica            Canada             Europe             HST                Libya              PST8PDT            US                 right\nAntarctica         Chile              Factory            Hongkong           MET                Pacific            UTC                zone.tab\nArctic             Cuba               GB                 Iceland            MST                Poland             Universal          zone1970.tab\nAsia               EET                GB-Eire            Indian             MST7MDT            Portugal           W-SU\nAtlantic           EST                GMT                Iran               Mexico             ROC                WET\nAustralia          EST5EDT            GMT+0              Israel             NZ                 ROK                Zulu\nBrazil             Egypt              GMT-0              Jamaica            NZ-CHAT            Singapore          iso3166.tab\nCET                Eire               GMT0               Japan              Navajo             Turkey             leap-seconds.list\n","filename":"Output","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"Africa             CST6CDT            Etc                Greenwich          Kwajalein          PRC                UCT                posixrules       \nAmerica            Canada             Europe             HST                Libya              PST8PDT            US                 right\nAntarctica         Chile              Factory            Hongkong           MET                Pacific            UTC                zone.tab\nArctic             Cuba               GB                 Iceland            MST                Poland             Universal          zone1970.tab\nAsia               EET                GB-Eire            Indian             MST7MDT            Portugal           W-SU\nAtlantic           EST                GMT                Iran               Mexico             ROC                WET\nAustralia          EST5EDT            GMT+0              Israel             NZ                 ROK                Zulu\nBrazil             Egypt              GMT-0              Jamaica            NZ-CHAT            Singapore          iso3166.tab\nCET                Eire               GMT0               Japan              Navajo             Turkey             leap-seconds.list\n"}]}]}]},{"type":"element","tag":"h3","props":{"id":"set-a-symbolic-link-to-the-desired-time-zone-in-the-localtime-file"},"children":[{"type":"text","value":"Set a symbolic link to the desired time zone in the localtime file."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Since I will set the time zone to Korean time, I will set a symbolic link to the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Asia/Seoul"}]},{"type":"text","value":" file.\nThe target path of the symbolic link is "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/etc/localtime"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"code":"ln -s /usr/share/zoneinfo/Asia/Seoul /etc/localtime \n","filename":"Terminal","language":"bash","meta":"","className":"language-bash shiki shiki-themes github-light material-theme-ocean","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"ln"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" -s"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" /usr/share/zoneinfo/Asia/Seoul"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" /etc/localtime\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"optional-specify-a-timezone-explicitly-in-the-timezone-file"},"children":[{"type":"text","value":"(Optional) Specify a timezone explicitly in the timezone file."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Although the time zone set in "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/etc/timezone"}]},{"type":"text","value":" is not reflected, it is recommended to specify it for explicit use."}]},{"type":"element","tag":"pre","props":{"code":"echo \"Asia/Seoul\" > /etc/timezone\n","filename":"Terminal","language":"bash","meta":"","className":"language-bash shiki shiki-themes github-light material-theme-ocean","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5;--shiki-dark:#82AAFF"},"children":[{"type":"text","value":"echo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":"Asia/Seoul"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#89DDFF"},"children":[{"type":"text","value":" >"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" /etc/timezone\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"check-with-date-command"},"children":[{"type":"text","value":"Check with "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"date"}]},{"type":"text","value":" command"}]},{"type":"element","tag":"code-group","props":{},"children":[{"type":"element","tag":"pre","props":{"code":"date\n","filename":"Terminal","language":"bash","meta":"","className":"language-bash shiki shiki-themes github-light material-theme-ocean","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"date\n"}]}]}]}]},{"type":"element","tag":"pre","props":{"code":"Fri May 12 12:44:46 KST 2023\n","filename":"Output","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"Fri May 12 12:44:46 KST 2023\n"}]}]}]},{"type":"element","tag":"h2","props":{"id":"time-zone-settings-in-docker-environment"},"children":[{"type":"text","value":"Time zone settings in Docker environment"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"When setting up the Alpine Linux time zone in a Docker environment, simply write each step described above in a Docker file.\nYou can optimize time zone settings in the Docker environment through single-stage build and multi-stage build that can be selected depending on the project environment."}]},{"type":"element","tag":"h3","props":{"id":"single-stage-build"},"children":[{"type":"text","value":"Single stage build"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Single-stage builds are used in simple environments and build the image by performing each step sequentially.\nHere's how to build a Docker image using a single stage build."}]},{"type":"element","tag":"pre","props":{"code":"FROM node:18.16.0-alpine3.17  \n\nRUN apk add --no-cache tzdata && \\\n    cp /usr/share/zoneinfo/Asia/Seoul /etc/localtime && \\\n    echo \"Asia/Seoul\" > /etc/timezone && \\\n    apk del tzdata\n","filename":"Dockerfile","highlights":[3,4,6],"language":"docker","meta":"","className":"language-docker shiki shiki-themes github-light material-theme-ocean","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F78C6C"},"children":[{"type":"text","value":"FROM"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#BABED8"},"children":[{"type":"text","value":" node:18.16.0-alpine3.17  \n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":["line","highlight"],"line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F78C6C"},"children":[{"type":"text","value":"RUN"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#BABED8"},"children":[{"type":"text","value":" apk add --no-cache tzdata && \\\n"}]}]},{"type":"element","tag":"span","props":{"class":["line","highlight"],"line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#BABED8"},"children":[{"type":"text","value":"    cp /usr/share/zoneinfo/Asia/Seoul /etc/localtime && \\\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#BABED8"},"children":[{"type":"text","value":"    echo "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":"\"Asia/Seoul\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#BABED8"},"children":[{"type":"text","value":" > /etc/timezone && \\\n"}]}]},{"type":"element","tag":"span","props":{"class":["line","highlight"],"line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#BABED8"},"children":[{"type":"text","value":"    apk del tzdata\n"}]}]}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Line 3: The "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"--no-cache"}]},{"type":"text","value":" flag is used, which is used to make the image lighter by not storing a cache when installing a package."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Line 4: Since we will delete the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"tzdata"}]},{"type":"text","value":" package, copy it without setting a symbolic link."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Line 6: Lighten the image by deleting the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"tzdata"}]},{"type":"text","value":" package that is no longer needed."}]}]},{"type":"element","tag":"h3","props":{"id":"multi-stage-build"},"children":[{"type":"text","value":"Multi-stage build"}]},{"type":"element","tag":"alert","props":{"title":"What are multi-stage builds?"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This function is supported starting from Docker v17.06, and is a function that divides the Docker image into stages to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"easily exclude elements that are necessary in the building process but not necessary in the final result."}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Multi-stage builds have strengths in complex environments, dividing the build process into multiple stages to include only the files needed in the final image.\nHere's how to build a Docker image using a multi-stage build."}]},{"type":"element","tag":"pre","props":{"code":"FROM node:18.16.0-alpine3.17 AS base\n\n# Builder process\nFROM base AS builder\n\nRUN apk add tzdata\n\n# Runner process\nFROM base AS runner\n\nCOPY --from=builder /usr/share/zoneinfo/Asia/Seoul /etc/localtime\nRUN echo \"Asia/Seoul\" > /etc/timezone\n","filename":"Dockerfile","language":"docker","meta":"","className":"language-docker shiki shiki-themes github-light material-theme-ocean","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F78C6C"},"children":[{"type":"text","value":"FROM"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#BABED8"},"children":[{"type":"text","value":" node:18.16.0-alpine3.17 "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F78C6C"},"children":[{"type":"text","value":"AS"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#BABED8"},"children":[{"type":"text","value":" base\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A737D;--shiki-dark:#464B5D;--shiki-default-font-style:inherit;--shiki-dark-font-style:italic"},"children":[{"type":"text","value":"# Builder process\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F78C6C"},"children":[{"type":"text","value":"FROM"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#BABED8"},"children":[{"type":"text","value":" base "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F78C6C"},"children":[{"type":"text","value":"AS"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#BABED8"},"children":[{"type":"text","value":" builder\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F78C6C"},"children":[{"type":"text","value":"RUN"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#BABED8"},"children":[{"type":"text","value":" apk add tzdata\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A737D;--shiki-dark:#464B5D;--shiki-default-font-style:inherit;--shiki-dark-font-style:italic"},"children":[{"type":"text","value":"# Runner process\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F78C6C"},"children":[{"type":"text","value":"FROM"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#BABED8"},"children":[{"type":"text","value":" base "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F78C6C"},"children":[{"type":"text","value":"AS"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#BABED8"},"children":[{"type":"text","value":" runner\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F78C6C"},"children":[{"type":"text","value":"COPY"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#BABED8"},"children":[{"type":"text","value":" --from=builder /usr/share/zoneinfo/Asia/Seoul /etc/localtime\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F78C6C"},"children":[{"type":"text","value":"RUN"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#BABED8"},"children":[{"type":"text","value":" echo "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":"\"Asia/Seoul\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#BABED8"},"children":[{"type":"text","value":" > /etc/timezone\n"}]}]}]}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"time-zone-settings-in-local-environment","depth":2,"text":"Time zone settings in local environment","children":[{"id":"installing-the-tzdata-package","depth":3,"text":"Installing the tzdata package"},{"id":"set-a-symbolic-link-to-the-desired-time-zone-in-the-localtime-file","depth":3,"text":"Set a symbolic link to the desired time zone in the localtime file."},{"id":"optional-specify-a-timezone-explicitly-in-the-timezone-file","depth":3,"text":"(Optional) Specify a timezone explicitly in the timezone file."},{"id":"check-with-date-command","depth":3,"text":"Check with date command"}]},{"id":"time-zone-settings-in-docker-environment","depth":2,"text":"Time zone settings in Docker environment","children":[{"id":"single-stage-build","depth":3,"text":"Single stage build"},{"id":"multi-stage-build","depth":3,"text":"Multi-stage build"}]}]}},"_type":"markdown","_id":"content:en:blog:2024:03:1.setting-the-timezone-in-alpine.md","_source":"content","_file":"en/blog/2024/03/1.setting-the-timezone-in-alpine.md","_extension":"md"}]